SELECT COUNT(1) AS ROW_COUNT FROM (
    SELECT TMAP.OGR_FID , TMAP.UTMMAP1, TMAP.UTMMAP2, TMAP.UTMMAP3, TMAP.UTMMAP4 , TMAP.UTMSCALE , tMap.LAND_NO , tLand.LAND_NO AS LAND_LINK, ROWNUM AS rn
    FROM MAP_.MAP_LAND_GIS_47 tMap
    LEFT JOIN (
        SELECT *
        FROM (
            SELECT
                CASE WHEN CADASTRAL_LAND_UTMMAP1_ IS NOT NULL THEN CADASTRAL_LAND_UTMMAP1_ ELSE CADASTRAL_LAND_UTMMAP1 END UTMMAP1,
                CASE WHEN CADASTRAL_LAND_UTMMAP2_ IS NOT NULL THEN CADASTRAL_LAND_UTMMAP2_ ELSE CADASTRAL_LAND_UTMMAP2 END UTMMAP2,
                CASE WHEN CADASTRAL_LAND_UTMMAP3_ IS NOT NULL THEN CADASTRAL_LAND_UTMMAP3_ ELSE CADASTRAL_LAND_UTMMAP3 END UTMMAP3,
                CASE WHEN CADASTRAL_LAND_UTMMAP4_ IS NOT NULL THEN LPAD(CADASTRAL_LAND_UTMMAP4_, 2, '00') ELSE LPAD(CADASTRAL_LAND_UTMMAP4_, 2, '00') END UTMMAP4,
                CASE WHEN SCALE_MAP_ IS NOT NULL THEN SCALE_MAP_ ELSE SCALE_MAP END UTMSCALE,
                CASE WHEN CADASTRAL_LAND_NO_ IS NOT NULL THEN CADASTRAL_LAND_NO_ ELSE CADASTRAL_LAND_NO END LAND_NO
            FROM SVA_.TB_SVA_CADASTRAL_LAND
            WHERE RECORD_STATUS = 'N'
                AND ZONE_LAND = 47
        ) t
        GROUP BY t.UTMMAP1, t.UTMMAP2, t.UTMMAP3, t.UTMMAP4, t.UTMSCALE, t.LAND_NO
    ) tLand
    ON TMAP.UTMMAP1 = tLand.UTMMAP1
    AND TMAP.UTMMAP2 = tLand.UTMMAP2
    AND TMAP.UTMMAP3 = tLand.UTMMAP3
    AND TMAP.UTMMAP4 = tLand.UTMMAP4
    AND TMAP.UTMSCALE = tLand.UTMSCALE
    AND TMAP.LAND_NO = tLand.LAND_NO
    WHERE (:LANDOFFICE_SEQ IS NULL OR tMap.LANDOFFICE_SEQ = :LANDOFFICE_SEQ)
        AND tMap.PARCEL_TYPE NOT IN (13, 14, 99)
        AND NVL(tMap.LAND_NO, 0) <> 0
        AND (:UTMMAP1 IS NULL OR tMap.UTMMAP1 = :UTMMAP1)
        AND (:UTMMAP2 IS NULL OR tMap.UTMMAP2 = :UTMMAP2)
        AND (:UTMMAP3 IS NULL OR tMap.UTMMAP3 = :UTMMAP3)
        AND (:UTMMAP4 IS NULL OR tMap.UTMMAP4 = :UTMMAP4)
        AND (:UTMSCALE IS NULL OR tMap.UTMSCALE = :UTMSCALE)
        AND (:LAND_NO IS NULL OR tMap.LAND_NO = :LAND_NO)
    ORDER BY tMap.UTMMAP1, tMap.UTMMAP2, tMap.UTMMAP3, tMap.UTMMAP4, tMap.UTMSCALE, tMap.LAND_NO
)